<!DOCTYPE html>
<!-- saved from url=(0040)http://www.tjtech.me/sdio-card-init.html -->
<html class="no-js" style="scroll-behavior: auto;"><!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]--><!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]--><!--[if gt IE 8]><!--><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
	<meta name="viewport" content="width=device-width,user-scalable=no">
    <title>SDIO Card初始化分析 - TJ的技术博客</title>
    <link rel="stylesheet" href="./SDIO Card初始化分析 - TJ的技术博客_files/normalize.css">
    <link rel="stylesheet" href="./SDIO Card初始化分析 - TJ的技术博客_files/style.css">
    <meta name="description" content="SDIO Card全称是Secure Digital Input Output Card，它是在SD memory card的基础上扩展了I/O功能。SDIO再加上memory就变成了Combo...">
<meta name="keywords" content="sdio card">
<link rel="pingback" href="http://www.tjtech.me/action/xmlrpc">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.tjtech.me/action/xmlrpc?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.tjtech.me/action/xmlrpc?wlw">
<link rel="alternate" type="application/rss+xml" title="SDIO Card初始化分析 » TJ的技术博客 » RSS 2.0" href="http://www.tjtech.me/feed/sdio-card-init.html">
<link rel="alternate" type="application/rdf+xml" title="SDIO Card初始化分析 » TJ的技术博客 » RSS 1.0" href="http://www.tjtech.me/feed/rss/sdio-card-init.html">
<link rel="alternate" type="application/atom+xml" title="SDIO Card初始化分析 » TJ的技术博客 » ATOM 1.0" href="http://www.tjtech.me/feed/atom/sdio-card-init.html">
<script type="text/javascript">
(function () {
    window.TypechoComment = {
        dom : function (id) {
            return document.getElementById(id);
        },
    
        create : function (tag, attr) {
            var el = document.createElement(tag);
        
            for (var key in attr) {
                el.setAttribute(key, attr[key]);
            }
        
            return el;
        },

        reply : function (cid, coid) {
            var comment = this.dom(cid), parent = comment.parentNode,
                response = this.dom('respond-post-566'), input = this.dom('comment-parent'),
                form = 'form' == response.tagName ? response : response.getElementsByTagName('form')[0],
                textarea = response.getElementsByTagName('textarea')[0];

            if (null == input) {
                input = this.create('input', {
                    'type' : 'hidden',
                    'name' : 'parent',
                    'id'   : 'comment-parent'
                });

                form.appendChild(input);
            }

            input.setAttribute('value', coid);

            if (null == this.dom('comment-form-place-holder')) {
                var holder = this.create('div', {
                    'id' : 'comment-form-place-holder'
                });

                response.parentNode.insertBefore(holder, response);
            }

            comment.appendChild(response);
            this.dom('cancel-comment-reply-link').style.display = '';

            if (null != textarea && 'text' == textarea.name) {
                textarea.focus();
            }

            return false;
        },

        cancelReply : function () {
            var response = this.dom('respond-post-566'),
            holder = this.dom('comment-form-place-holder'), input = this.dom('comment-parent');

            if (null != input) {
                input.parentNode.removeChild(input);
            }

            if (null == holder) {
                return true;
            }

            this.dom('cancel-comment-reply-link').style.display = 'none';
            holder.parentNode.insertBefore(response, holder);
            return false;
        }
    };
})();
</script>
<script type="text/javascript">
(function () {
    var event = document.addEventListener ? {
        add: 'addEventListener',
        triggers: ['scroll', 'mousemove', 'keyup', 'touchstart'],
        load: 'DOMContentLoaded'
    } : {
        add: 'attachEvent',
        triggers: ['onfocus', 'onmousemove', 'onkeyup', 'ontouchstart'],
        load: 'onload'
    }, added = false;

    document[event.add](event.load, function () {
        var r = document.getElementById('respond-post-566'),
            input = document.createElement('input');
        input.type = 'hidden';
        input.name = '_';
        input.value = (function () {
    var _uM9n = 'd'//'LHs'
+//'hxy'
'920'+//'bc'
'6'+'618'//'V8'
+//'u4'
'1'+//'YZy'
'3'+//'843'
'f'+''///*'g'*/'g'
+'4c'//'Rv'
+//'z'
'7'+'78'//'f'
+'a4'//'CE'
+//'U'
'2b1'+''///*'Q2'*/'Q2'
+//'M'
'd4b'+'3a5'//'d'
+'a4'//'X'
+//'AmF'
'3f'+//'nFl'
'4', _7lLJ = [];
    
    for (var i = 0; i < _7lLJ.length; i ++) {
        _uM9n = _uM9n.substring(0, _7lLJ[i][0]) + _uM9n.substring(_7lLJ[i][1]);
    }

    return _uM9n;
})();

        if (null != r) {
            var forms = r.getElementsByTagName('form');
            if (forms.length > 0) {
                function append() {
                    if (!added) {
                        forms[0].appendChild(input);
                        added = true;
                    }
                }
            
                for (var i = 0; i < event.triggers.length; i ++) {
                    var trigger = event.triggers[i];
                    document[event.add](trigger, append);
                    window[event.add](trigger, append);
                }
            }
        }
    });
})();
</script><link rel="stylesheet" type="text/css" href="./SDIO Card初始化分析 - TJ的技术博客_files/default.css"><script src="./SDIO Card初始化分析 - TJ的技术博客_files/share.js.下载"></script><script src="./SDIO Card初始化分析 - TJ的技术博客_files/clipboard.min.js.下载"></script><link rel="stylesheet" href="./SDIO Card初始化分析 - TJ的技术博客_files/layer.css" id="layui_layer_skinlayercss" style=""><link rel="stylesheet" href="./SDIO Card初始化分析 - TJ的技术博客_files/share_style0_16.css"><style></style></head>
<body>

<header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                                    <a id="logo" href="http://tjtech.me/">
                        TJ的技术博客                    </a>
                        	    <p class="description"></p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class=" current" href="http://tjtech.me/">首页</a>
															<a href="http://www.tjtech.me/about.html" title="关于">关于</a>
									</nav>
            </div>
        </div>
    </div>
</header>
<div id="body">
    <div class="container">
        <div class="col-group">
<div class="col-8" id="main">
	<div class="res-cons">
		<article class="post">
			<header>
				<h1 class="post-title">SDIO Card初始化分析</h1>
			</header>
			<date class="post-meta">
                                2020-05-30                                &nbsp; | &nbsp;&nbsp;浏览 (2,265)			</date>
			<div class="post-content">
				<p>SDIO Card全称是Secure Digital Input Output Card，它是在SD memory card的基础上扩展了I/O功能。SDIO再加上memory就变成了Combo card(组合卡?)，这里主要看下SDIO card。</p><p>SDIO card分快(High-Speed)慢(Low-Speed)两种版本。传输模式分为SPI和SD两种，SD又分成1-bit和4-bit，SPI和1-bit SD是强制要求，SD 4-bit是快速SDIO card必备了。</p><h2>SD mode卡初始化流程图</h2><p>先来看下Spec的初始化流程图，重点关注SDIO card(红线)：</p><p><img src="./SDIO Card初始化分析 - TJ的技术博客_files/2910362261.png" alt="card_ini_flow_in_sd_mode.png" title="card_ini_flow_in_sd_mode.png"></p><p><img src="./SDIO Card初始化分析 - TJ的技术博客_files/567224915.png" alt="card_ini_flow_in_sd_mode_cont.png" title="card_ini_flow_in_sd_mode_cont.png"></p><p>提下图上的几个term含义：</p><p>OCR: Operation Conditions Register. The supported minimum and maximum values for VDD.</p><p>RCA: relative card address register, 所有的功能都共享同样的card addess。</p><p>CMD5: 是IO_SEND_OP_COND command，用来获取OCR。</p><p>CMD3: 是SEND_RELATIVE_ADDR command，用来获取RCA。</p><h2>Linux Kernel初始化</h2><p>参考5.x, 相关code文件如下：</p><div class="code-toolbar"><pre class=" language-bash"><code class=" language-bash">linaro@rpi:~/code/kernel/linux/drivers/mmc$ <span class="token function">ls</span> -l core/sdio*
-rw-r--r-- 1 linaro linaro  8407 Feb  5 10:58 core/sdio_bus.c
-rw-r--r-- 1 linaro linaro   443 Feb  5 10:58 core/sdio_bus.h
-rw-r--r-- 1 linaro linaro 28230 Feb  5 10:58 core/sdio.c
-rw-r--r-- 1 linaro linaro  9021 Feb  5 10:58 core/sdio_cis.c
-rw-r--r-- 1 linaro linaro   476 Feb  5 10:58 core/sdio_cis.h
-rw-r--r-- 1 linaro linaro 21666 Feb  5 10:58 core/sdio_io.c
-rw-r--r-- 1 linaro linaro  8952 Feb  5 10:58 core/sdio_irq.c
-rw-r--r-- 1 linaro linaro  4601 Feb  5 10:58 core/sdio_ops.c
-rw-r--r-- 1 linaro linaro   932 Feb  5 10:58 core/sdio_ops.h</code></pre><div class="toolbar"><div class="toolbar-item"><span>Bash</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>初始化入口：</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c"><span class="token keyword">int</span> <span class="token function">mmc_attach_sdio</span><span class="token punctuation">(</span><span class="token keyword">struct</span> mmc_host <span class="token operator">*</span>host<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">int</span> err<span class="token punctuation">,</span> i<span class="token punctuation">,</span> funcs<span class="token punctuation">;</span>
        u32 ocr<span class="token punctuation">,</span> rocr<span class="token punctuation">;</span>
        <span class="token keyword">struct</span> mmc_card <span class="token operator">*</span>card<span class="token punctuation">;</span>

        <span class="token function">WARN_ON</span><span class="token punctuation">(</span><span class="token operator">!</span>host<span class="token operator">-&gt;</span>claimed<span class="token punctuation">)</span><span class="token punctuation">;</span>

        err <span class="token operator">=</span> <span class="token function">mmc_send_io_op_cond</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ocr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                <span class="token keyword">return</span> err<span class="token punctuation">;</span> 

        <span class="token function">mmc_attach_bus</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> <span class="token operator">&amp;</span>mmc_sdio_ops<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>host<span class="token operator">-&gt;</span>ocr_avail_sdio<span class="token punctuation">)</span>
                host<span class="token operator">-&gt;</span>ocr_avail <span class="token operator">=</span> host<span class="token operator">-&gt;</span>ocr_avail_sdio<span class="token punctuation">;</span>


        rocr <span class="token operator">=</span> <span class="token function">mmc_select_voltage</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> ocr<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/*
         * Can we support the voltage(s) of the card(s)?
         */</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>rocr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                err <span class="token operator">=</span> <span class="token operator">-</span>EINVAL<span class="token punctuation">;</span>
                <span class="token keyword">goto</span> err<span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>

</code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>先走<code>mmc_send_io_op_cond()</code>获得ocr：</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c"><span class="token macro property">#<span class="token directive keyword">define</span> SD_IO_SEND_OP_COND          5 </span><span class="token comment">/* bcr  [23:0] OCR         R4  */</span>

<span class="token keyword">int</span> <span class="token function">mmc_send_io_op_cond</span><span class="token punctuation">(</span><span class="token keyword">struct</span> mmc_host <span class="token operator">*</span>host<span class="token punctuation">,</span> u32 ocr<span class="token punctuation">,</span> u32 <span class="token operator">*</span>rocr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">struct</span> mmc_command cmd <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        <span class="token keyword">int</span> i<span class="token punctuation">,</span> err <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        cmd<span class="token punctuation">.</span>opcode <span class="token operator">=</span> SD_IO_SEND_OP_COND<span class="token punctuation">;</span>
        cmd<span class="token punctuation">.</span>arg <span class="token operator">=</span> ocr<span class="token punctuation">;</span>
        cmd<span class="token punctuation">.</span>flags <span class="token operator">=</span> MMC_RSP_SPI_R4 <span class="token operator">|</span> MMC_RSP_R4 <span class="token operator">|</span> MMC_CMD_BCR<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                err <span class="token operator">=</span> <span class="token function">mmc_wait_for_cmd</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cmd<span class="token punctuation">,</span> MMC_CMD_RETRIES<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>

                <span class="token comment">/* if we're just probing, do a single pass */</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ocr <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment">//tj: here</span>

                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>rocr<span class="token punctuation">)</span>
                <span class="token operator">*</span>rocr <span class="token operator">=</span> cmd<span class="token punctuation">.</span>resp<span class="token punctuation">[</span><span class="token function">mmc_host_is_spi</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//tj: get OCR</span>

        <span class="token keyword">return</span> err<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>这里<code>ocr</code>传进来就是0，被定义为probing。如果host支持，<code>mmc_host_is_spi()</code>会在drivers/mmc/host/mmc_spi.c里定义。</p><p>下来select voltage:</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c"><span class="token comment">/*
 * Mask off any voltages we don't support and select
 * the lowest voltage
 */</span>
u32 <span class="token function">mmc_select_voltage</span><span class="token punctuation">(</span><span class="token keyword">struct</span> mmc_host <span class="token operator">*</span>host<span class="token punctuation">,</span> u32 ocr<span class="token punctuation">)</span> </code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>电压test and select后，进入探测初始化<code>mmc_sdio_init_card(host, rocr, NULL)</code>：</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c"><span class="token comment">/*
 * Handle the detection and initialisation of a card.
 *
 * In the case of a resume, "oldcard" will contain the card
 * we're trying to reinitialise.
 */</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">mmc_sdio_init_card</span><span class="token punctuation">(</span><span class="token keyword">struct</span> mmc_host <span class="token operator">*</span>host<span class="token punctuation">,</span> u32 ocr<span class="token punctuation">,</span> 
                              <span class="token keyword">struct</span> mmc_card <span class="token operator">*</span>oldcard<span class="token punctuation">)</span>
<span class="token punctuation">{</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p><code>oldcard</code>是给reinit用，探测传入是<code>NULL</code>，暂不关心。看下这个接口主要做了哪些事情，这里不关心SPI mode：</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c">        <span class="token comment">/*
         * Inform the card of the voltage
         */</span>
        err <span class="token operator">=</span> <span class="token function">mmc_send_io_op_cond</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> ocr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rocr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                <span class="token keyword">goto</span> err<span class="token punctuation">;</span> </code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>首先把之前select的voltage再设置下，然后根据响应<code>rocr</code>里是否有MP flag(<code>R4_MEMORY_PRESENT</code>)区分出SDIO card type(<code>MMC_TYPE_SDIO</code>)。</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>rocr <span class="token operator">&amp;</span> R4_MEMORY_PRESENT<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
            <span class="token function">mmc_sd_get_cid</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> ocr <span class="token operator">&amp;</span> rocr<span class="token punctuation">,</span> card<span class="token operator">-&gt;</span>raw_cid<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                card<span class="token operator">-&gt;</span>type <span class="token operator">=</span> MMC_TYPE_SD_COMBO<span class="token punctuation">;</span>
                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                card<span class="token operator">-&gt;</span>type <span class="token operator">=</span> MMC_TYPE_SDIO<span class="token punctuation">;</span>
                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>接下来set card RCA：</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c">        <span class="token comment">/*
         * For native busses:  set card RCA and quit open drain mode.
         */</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">mmc_host_is_spi</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                err <span class="token operator">=</span> <span class="token function">mmc_send_relative_addr</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> <span class="token operator">&amp;</span>card<span class="token operator">-&gt;</span>rca<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                        <span class="token keyword">goto</span> remove<span class="token punctuation">;</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><div class="code-toolbar"><pre class=" language-c"><code class=" language-c"><span class="token keyword">int</span> <span class="token function">mmc_send_relative_addr</span><span class="token punctuation">(</span><span class="token keyword">struct</span> mmc_host <span class="token operator">*</span>host<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>rca<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">int</span> err<span class="token punctuation">;</span>
        <span class="token keyword">struct</span> mmc_command cmd <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 

        cmd<span class="token punctuation">.</span>opcode <span class="token operator">=</span> SD_SEND_RELATIVE_ADDR<span class="token punctuation">;</span>
        cmd<span class="token punctuation">.</span>arg <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        cmd<span class="token punctuation">.</span>flags <span class="token operator">=</span> MMC_RSP_R6 <span class="token operator">|</span> MMC_CMD_BCR<span class="token punctuation">;</span>

        err <span class="token operator">=</span> <span class="token function">mmc_wait_for_cmd</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cmd<span class="token punctuation">,</span> MMC_CMD_RETRIES<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                <span class="token keyword">return</span> err<span class="token punctuation">;</span>

        <span class="token operator">*</span>rca <span class="token operator">=</span> cmd<span class="token punctuation">.</span>resp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">;</span>  <span class="token comment">//tj: get RCA</span>

        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>then select card（due to 操作依赖）:</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c">        <span class="token comment">/*
         * Select card, as all following commands rely on that.
         */</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">mmc_host_is_spi</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                err <span class="token operator">=</span> <span class="token function">mmc_select_card</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                        <span class="token keyword">goto</span> remove<span class="token punctuation">;</span>
        <span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>then 读common information area(CIA)，包括CCCR(card common control)和CIS(card information struture):</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c">        <span class="token comment">/*
         * Read the common registers. Note that we should try to
         * validate whether UHS would work or not.
         */</span>
        err <span class="token operator">=</span> <span class="token function">sdio_read_cccr</span><span class="token punctuation">(</span>card<span class="token punctuation">,</span> ocr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token comment">/*
         * Read the common CIS tuples.
         */</span>
        err <span class="token operator">=</span> <span class="token function">sdio_read_common_cis</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>目的就是让host决定要用哪些功能，最后设置High-Speed if support/clock/4-bit SD if support:</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c">                <span class="token comment">/*   
                 * Switch to high-speed (if supported).
                 */</span>
                err <span class="token operator">=</span> <span class="token function">sdio_enable_hs</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

                <span class="token comment">/*   
                 * Change to the card's maximum speed.
                 */</span>
                <span class="token function">mmc_set_clock</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> <span class="token function">mmc_sdio_get_max_clock</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">/*   
                 * Switch to wider bus (if supported).
                 */</span>
                err <span class="token operator">=</span> <span class="token function">sdio_enable_4bit_bus</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>high-speed:</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c"><span class="token comment">/*
 * Enable SDIO/combo card's high-speed mode. Return 0/1 if [not]supported.
 */</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">sdio_enable_hs</span><span class="token punctuation">(</span><span class="token keyword">struct</span> mmc_card <span class="token operator">*</span>card<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">int</span> ret<span class="token punctuation">;</span> 

        ret <span class="token operator">=</span> <span class="token function">mmc_sdio_switch_hs</span><span class="token punctuation">(</span>card<span class="token punctuation">,</span> true<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> card<span class="token operator">-&gt;</span>type <span class="token operator">==</span> MMC_TYPE_SDIO<span class="token punctuation">)</span>
                <span class="token keyword">return</span> ret<span class="token punctuation">;</span> </code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>先test是否支持then切换：</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c"><span class="token comment">/*
 * Test if the card supports high-speed mode and, if so, switch to it.
 */</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">mmc_sdio_switch_hs</span><span class="token punctuation">(</span><span class="token keyword">struct</span> mmc_card <span class="token operator">*</span>card<span class="token punctuation">,</span> <span class="token keyword">int</span> enable<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">int</span> ret<span class="token punctuation">;</span>
        u8 speed<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>card<span class="token operator">-&gt;</span>host<span class="token operator">-&gt;</span>caps <span class="token operator">&amp;</span> MMC_CAP_SD_HIGHSPEED<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>card<span class="token operator">-&gt;</span>cccr<span class="token punctuation">.</span>high_speed<span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

        ret <span class="token operator">=</span> <span class="token function">mmc_io_rw_direct</span><span class="token punctuation">(</span>card<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> SDIO_CCCR_SPEED<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>speed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//tj:read</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
                <span class="token keyword">return</span> ret<span class="token punctuation">;</span> 

        <span class="token keyword">if</span> <span class="token punctuation">(</span>enable<span class="token punctuation">)</span>
                speed <span class="token operator">|</span><span class="token operator">=</span> SDIO_SPEED_EHS<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
                speed <span class="token operator">&amp;</span><span class="token operator">=</span> <span class="token operator">~</span>SDIO_SPEED_EHS<span class="token punctuation">;</span>

        ret <span class="token operator">=</span> <span class="token function">mmc_io_rw_direct</span><span class="token punctuation">(</span>card<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> SDIO_CCCR_SPEED<span class="token punctuation">,</span> speed<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//tj:write</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
                <span class="token keyword">return</span> ret<span class="token punctuation">;</span> 

        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>4-bit:</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c"><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">sdio_enable_4bit_bus</span><span class="token punctuation">(</span><span class="token keyword">struct</span> mmc_card <span class="token operator">*</span>card<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">int</span> err<span class="token punctuation">;</span> 

        <span class="token keyword">if</span> <span class="token punctuation">(</span>card<span class="token operator">-&gt;</span>type <span class="token operator">==</span> MMC_TYPE_SDIO<span class="token punctuation">)</span>
                err <span class="token operator">=</span> <span class="token function">sdio_enable_wide</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>先test是否支持then配置4-bit：</p><div class="code-toolbar"><pre class=" language-c"><code class=" language-c"><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">sdio_enable_wide</span><span class="token punctuation">(</span><span class="token keyword">struct</span> mmc_card <span class="token operator">*</span>card<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">int</span> ret<span class="token punctuation">;</span> 
        u8 ctrl<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>card<span class="token operator">-&gt;</span>host<span class="token operator">-&gt;</span>caps <span class="token operator">&amp;</span> MMC_CAP_4_BIT_DATA<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>card<span class="token operator">-&gt;</span>cccr<span class="token punctuation">.</span>low_speed <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>card<span class="token operator">-&gt;</span>cccr<span class="token punctuation">.</span>wide_bus<span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

        ret <span class="token operator">=</span> <span class="token function">mmc_io_rw_direct</span><span class="token punctuation">(</span>card<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> SDIO_CCCR_IF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ctrl<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//tj: read</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
                <span class="token keyword">return</span> ret<span class="token punctuation">;</span> 

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ctrl <span class="token operator">&amp;</span> SDIO_BUS_WIDTH_MASK<span class="token punctuation">)</span> <span class="token operator">==</span> SDIO_BUS_WIDTH_RESERVED<span class="token punctuation">)</span>
                <span class="token function">pr_warn</span><span class="token punctuation">(</span><span class="token string">"%s: SDIO_CCCR_IF is invalid: 0x%02x\n"</span><span class="token punctuation">,</span>
                        <span class="token function">mmc_hostname</span><span class="token punctuation">(</span>card<span class="token operator">-&gt;</span>host<span class="token punctuation">)</span><span class="token punctuation">,</span> ctrl<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/* set as 4-bit bus width */</span>
        ctrl <span class="token operator">&amp;</span><span class="token operator">=</span> <span class="token operator">~</span>SDIO_BUS_WIDTH_MASK<span class="token punctuation">;</span>
        ctrl <span class="token operator">|</span><span class="token operator">=</span> SDIO_BUS_WIDTH_4BIT<span class="token punctuation">;</span>

        ret <span class="token operator">=</span> <span class="token function">mmc_io_rw_direct</span><span class="token punctuation">(</span>card<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> SDIO_CCCR_IF<span class="token punctuation">,</span> ctrl<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//tj: write</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
                <span class="token keyword">return</span> ret<span class="token punctuation">;</span> 

        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>C</span></div><div class="toolbar-item"><a>Copy</a></div></div></div><p>Done.</p><p>BTW: Mobile bootloader seems do not support SDIO card, but i can:]</p>							</div>

                <div class="open-msg">
                        <p>本站采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>进行许可 | 转载请注明原文链接 - <a href="http://www.tjtech.me/sdio-card-init.html">SDIO Card初始化分析</a></p>
                </div>
	

<div class="bdsharebuttonbox bdshare-button-style0-16" style="float:right;" data-bd-bind="1650607496370">
<a href="http://www.tjtech.me/sdio-card-init.html#" class="bds_weixin" data-cmd="weixin" title="分享到微信">分享到微信</a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>

		</article>
<div class="post-reward">
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById(&#39;QR&#39;); if (qr.style.display === &#39;none&#39;) {qr.style.display=&#39;block&#39;;} else {qr.style.display=&#39;none&#39;}">
    <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
        <div id="" style="text-align:center; font-style:italic;">打赏请备注: tjtech</div>
        <div id="alipay" style="display: inline-block">
            <a class="fancybox" rel="group"><img id="alipay_qr" src="./SDIO Card初始化分析 - TJ的技术博客_files/tj-zhifubao.png" alt="Èþ Alipay"></a>
        </div>
        <div id="wechat" style="display: inline-block">
            <a class="fancybox" rel="group"><img id="wechat_qr" src="./SDIO Card初始化分析 - TJ的技术博客_files/tj-wxzhifu.png" alt="Èþ WeChat Pay"></a>
        </div>
    </div>
</div>
		<div id="comments">
                <div id="respond-post-566" class="respond">
        <div class="cancel-comment-reply">
        <a id="cancel-comment-reply-link" href="http://www.tjtech.me/sdio-card-init.html#respond-post-566" rel="nofollow" style="display:none" onclick="return TypechoComment.cancelReply();">取消回复</a>        </div>
    	<span id="response" class="widget-title">添加新评论</span>
    	<form method="post" action="http://www.tjtech.me/sdio-card-init.html/comment" id="comment-form">
			<div class="col1">
			<p>
                <textarea rows="8" cols="50" name="text" class="textarea"></textarea>
            </p>
			</div>
			<div class="col2">
                		<p>
                <label for="author" class="required">称呼</label>
    			<input type="text" name="author" id="author" class="text" value="">
    		</p>
    		<p>
                <label for="mail" class="required">邮箱</label>
    			<input type="email" name="mail" id="mail" class="text" value="">
    		</p>
    		<p>
                <label for="url">网站</label>
    			<input type="url" name="url" id="url" class="text" placeholder="http://example.com" value="">
    		</p>
                		<p>
                <button type="submit" class="submit">提交评论</button>
            </p>
			</div>
			<div class="clear"></div>
    	<input type="hidden" name="_" value="d920661813f4c778a42b1d4b3a5a43f4"></form>
    </div>
    </div>	</div>
</div>
<div id="secondary">
	<section class="widget">
        <form id="search" method="post" action="http://www.tjtech.me/">
            <input type="text" name="s" class="text" placeholder="搜索...">
            <button type="submit" class="submit icon-search"></button>
        </form>
    </section>

	    <section class="widget">
		<h3 class="widget-title">最新文章</h3>
        <ul class="widget-list">
            <li><a href="http://www.tjtech.me/erofs-ztailpacking-explain.html">转：EROFS ztailpacking 特性实现详解</a></li><li><a href="http://www.tjtech.me/migrate-typecho-from-aliapp-to-cloudvm.html">从ali云弹性Web托管迁移Typecho到云虚拟主机遇坑说明</a></li><li><a href="http://www.tjtech.me/read_linux_vfs_read.html">Read vfs_read() code</a></li><li><a href="http://www.tjtech.me/erofs-compacted-index-generation.html">EROFS on-disk compact index 生成分析</a></li><li><a href="http://www.tjtech.me/transfer-files-between-qemu-and-host-via-mount.html">qemu和host间传输文件方法之挂载</a></li><li><a href="http://www.tjtech.me/support-android-map-blocklist-on-erofs.html">转：如何在EROFS上支持Android文件块映射</a></li><li><a href="http://www.tjtech.me/read_squashfs_readpage_code.html">Read squashfs readpage() code</a></li><li><a href="http://www.tjtech.me/epaper-weather-station.html">e-Paper Weather Station</a></li><li><a href="http://www.tjtech.me/erofs-mkfs-overview.html">erofs-utils mkfs 概览</a></li><li><a href="http://www.tjtech.me/mmc_cmdq_timeout.html">eMMC CMDQ 超时分析</a></li>        </ul>
    </section>
    
        <section class="widget">
		<h3 class="widget-title">最近回复</h3>
        <ul class="widget-list">
                            <li><a href="http://www.tjtech.me/analyze-linux-device-register-code.html#trackback-112">andere.strikingly.com</a>: You expres...</li>
                    <li><a href="http://www.tjtech.me/erofs-compacted-index-generation.html#comment-111">tj</a>: 这是index大小，...</li>
                    <li><a href="http://www.tjtech.me/erofs-compacted-index-generation.html#comment-110">HanQi</a>: 我的理解是，z_er...</li>
                    <li><a href="http://www.tjtech.me/erofs-compacted-index-generation.html#comment-109">HanQi</a>: 请问 z_erofs...</li>
                    <li><a href="http://www.tjtech.me/erofs-compacted-index-generation.html#comment-108">tj</a>: 上面是官方答复：)</li>
                    <li><a href="http://www.tjtech.me/erofs-compacted-index-generation.html#comment-107">HanQi</a>: 请问 compact...</li>
                    <li><a href="http://www.tjtech.me/erofs-compacted-index-generation.html#comment-106">Gao Xiang</a>: 因为compact ...</li>
                    <li><a href="http://www.tjtech.me/canned-fs-config-for-erofs-utils.html#comment-105">tj</a>: 用高版本的lz4了，...</li>
                    <li><a href="http://www.tjtech.me/canned-fs-config-for-erofs-utils.html#comment-103">Aladin</a>: Hi tj,
合入参...</li>
                    <li><a href="http://www.tjtech.me/how-to-make-and-mount-vendor-image-with-erofs.html#comment-102">Aladin</a>: 上传的链接能否发下，...</li>
                </ul>
    </section>
    
        <section class="widget">
		<h3 class="widget-title">分类</h3>
        <ul class="widget-list">
            <li><a href="http://www.tjtech.me/category/mm/">Memory Management</a> (22)</li><li><a href="http://www.tjtech.me/category/stab/">Stability</a> (24)</li><li><a href="http://www.tjtech.me/category/perf/">Performance</a> (8)</li><li><a href="http://www.tjtech.me/category/fs/">File System</a> (14)</li><li><a href="http://www.tjtech.me/category/dd/">Device Driver</a> (16)</li><li><a href="http://www.tjtech.me/category/security/">Security</a> (3)</li><li><a href="http://www.tjtech.me/category/msm/">MSM</a> (4)</li><li><a href="http://www.tjtech.me/category/arm/">ARM</a> (2)</li><li><a href="http://www.tjtech.me/category/iot/">IoT</a> (6)</li><li><a href="http://www.tjtech.me/category/tools/">Tools</a> (14)</li>        </ul>
	</section>
    
        <section class="widget">
		<h3 class="widget-title">归档</h3>
        <ul class="widget-list">
            <li><a href="http://www.tjtech.me/2022/">2022</a><span id="ignore"> (3)</span></li><li><a href="http://www.tjtech.me/2021/">2021</a><span id="ignore"> (10)</span></li><li><a href="http://www.tjtech.me/2020/">2020</a><span id="ignore"> (22)</span></li><li><a href="http://www.tjtech.me/2019/">2019</a><span id="ignore"> (20)</span></li><li><a href="http://www.tjtech.me/2018/">2018</a><span id="ignore"> (26)</span></li><li><a href="http://www.tjtech.me/2017/">2017</a><span id="ignore"> (28)</span></li>        </ul>
	</section>
    
    <section class="widget">
		<h3 class="widget-title">标签</h3>

  
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/erofs/">erofs</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/lmk/">LMK</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/kernel/">Linux Kernel</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/recovery/">recovery</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/cpufreq/">cpufreq</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/uefi/">uefi</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/crash/">crash</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/linux-patch/">linux patch</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/vxworks/">VxWorks</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/highmem/">High Memory</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/arm/">ARM</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/zone/">Zone</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/sd/">SD</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/memcg/">memcg</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/A-B/">A/B</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/ramoops/">ramoops</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/pstore/">pstore</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/qemu/">qemu</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/avb/">avb</a>
         
         <a style="border:1px solid #ddd; background: none; display: inline-block; padding:2px 4px 2px 4px; margin: 0 6px 8px 0;" rel="tag" href="http://www.tjtech.me/tag/sdio-card/">sdio card</a>
       
    </section>

    </div>
		</div>
    </div>
</div>
<footer id="footer">
	<div class="container">
		 ©  2022 <a href="https://beian.miit.gov.cn/">苏ICP备17014092号-1</a>
	</div>
</footer>
<script type="text/javascript" src="./SDIO Card初始化分析 - TJ的技术博客_files/prism.js.下载"></script>
<script type="text/javascript" src="./SDIO Card初始化分析 - TJ的技术博客_files/clipboard.min.js(1).下载"></script>

		<script src="./SDIO Card初始化分析 - TJ的技术博客_files/jquery.min.js.下载"></script>	
		<script src="./SDIO Card初始化分析 - TJ的技术博客_files/layer.js.下载"></script>
		<script src="./SDIO Card初始化分析 - TJ的技术博客_files/arpay.js.下载"></script>

</body></html>